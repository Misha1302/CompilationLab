<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Проектная подготовка — языки, компиляторы, JIT</title>

  <meta name="description" content="Проектная подготовка: языки, компиляторы и JIT для школьников — проекты, победы на олимпиадах и поддержка для поступления в топ-вуз." />
  <meta property="og:title" content="Проектная подготовка — языки, компиляторы, JIT" />
  <meta property="og:description" content="Малые команды, реальные инженерные проекты и сопровождение для участия в профильных олимпиадах и поступления в вузы." />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary_large_image" />

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:wght@600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fbfdfc;
      --card:#ffffff;
      --text:#0b1220;
      --muted:#4a565b;
      --accent:#3f6f63;
      --accent-2:#6fb9a8;
      --soft:#f3f7f6;
      --border:#e6eeec;
      --radius:14px;
      --maxw:1180px;
      --pad:24px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      line-height:1.6;
      font-size:18px;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
    }
    a{color:inherit;text-decoration:none}
    img{max-width:100%;height:auto;display:block}
    .container{max-width:var(--maxw);margin:0 auto;padding:0 var(--pad)}

    /* Header */
    header.site-header{background:var(--card);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:60}
    .header-inner{height:76px;display:flex;align-items:center;justify-content:space-between;gap:16px}
    .brand{display:flex;gap:14px;align-items:center}
    .logo-mark{width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:grid;place-items:center;color:#fff;font-weight:700;font-family:Merriweather}
    .brand-title{font-weight:700;font-size:18px}
    .brand-sub{font-size:13px;color:var(--muted)}

    /* Desktop nav */
    .nav{display:flex;gap:12px;align-items:center}
    .btn{padding:10px 16px;border-radius:10px;font-weight:600;font-size:15px;border:1px solid transparent;cursor:pointer}
    .btn-ghost{color:var(--accent);background:transparent}
    .btn-primary{background:var(--accent);color:#fff;box-shadow:0 8px 24px rgba(63,111,99,0.12)}

    /* mobile nav: toggle button + drawer */
    .nav-toggle{display:none;border:0;background:transparent;padding:10px;border-radius:10px;cursor:pointer}
    .nav-toggle .bar{display:block;width:22px;height:2px;background:var(--text);margin:4px 0;border-radius:2px}

    .nav-drawer{display:none;position:fixed;inset:0;background:rgba(11,18,22,0.45);z-index:70;align-items:flex-start;justify-content:flex-end}
    .nav-drawer .sheet{width:280px;background:var(--card);height:100%;padding:20px;border-left:1px solid var(--border);box-shadow:-20px 0 40px rgba(11,18,22,0.06)}
    .nav-drawer .sheet .nav{flex-direction:column;gap:12px}

    /* HERO */
    .hero{padding:56px 0 28px}
    .hero-grid{display:grid;grid-template-columns:1fr 420px;gap:28px;align-items:stretch}
    .hero-title{font-family:Merriweather,serif;font-size:40px;margin:0 0 10px;line-height:1.05}
    .hero-lead{color:var(--muted);font-size:18px;margin:0}
    .hero-cta{margin-top:18px;display:flex;gap:12px;flex-wrap:wrap}
    .hero-badges{display:flex;gap:10px;flex-wrap:wrap;margin-top:18px}
    .badge{background:var(--soft);padding:10px 12px;border-radius:10px;border:1px solid var(--border);font-weight:600;color:var(--accent)}

    .admission-badge{
      display:inline-block;background:linear-gradient(90deg,#fff6f1,#f7fff8);border:1px solid #dfeee6;color:var(--accent);padding:10px 12px;border-radius:12px;font-weight:700;margin-top:12px;
    }

    /* right panel */
    .panel.card{padding:22px;display:flex;flex-direction:column;gap:14px;border-radius:var(--radius);box-shadow:0 10px 30px rgba(17,20,22,0.03)}

    .screenshot {
      height:220px;
      background: linear-gradient(90deg,#f7faf9,#eef6f4);
      border-radius:12px;
      border:1px solid rgba(0,0,0,0.03);
      display:grid;place-items:center;
      color:var(--muted);font-weight:600;
      overflow:hidden; /* important: crop overflow */
    }
    .screenshot img{width:100%;height:100%;object-fit:cover;object-position:center;display:block}

    .visual-split{display:flex;gap:22px;align-items:stretch;flex-wrap:nowrap}
    .visual-left{flex:0 0 48%;display:block;position:relative}
    .visual-left .big-image{width:100%;height:100%;border-radius:32px;box-shadow: 0 18px 40px rgba(11,18,32,0.12), inset 0 -6px 18px rgba(11,18,32,0.02);overflow:hidden;display:block;min-height:260px}
    .visual-left .big-image img{width:130%;max-width:none;height:100%;object-fit:cover;object-position:left center;display:block}

    .visual-right{flex:1 1 52%;display:flex;flex-direction:column;justify-content:center;gap:12px;padding:6px 0}
    .visual-right h4{margin:0;font-size:18px}
    .visual-right p{margin:0;color:var(--muted)}
    .visual-right ul{margin:8px 0 0 18px;color:var(--muted)}
    .visual-right .small-cta{margin-top:12px;display:inline-flex;gap:10px}

    .cards-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin-top:30px}
    .info-card{background:var(--card);border:1px solid var(--border);padding:22px;border-radius:12px;box-shadow:0 8px 24px rgba(17,20,22,0.03)}
    .info-card h3{margin:0 0 10px}
    .info-card p{margin:0;color:var(--muted)}

    .ideas{display:grid;gap:12px;margin-top:12px}
    .idea{background:var(--soft);border-radius:10px;padding:12px;border:1px solid var(--border);color:var(--muted);font-weight:600}

    .contact-card{padding:20px;border-radius:12px;border:1px solid var(--border);background:var(--card)}
    label{display:block;font-weight:700;margin-bottom:6px}
    input,textarea{width:100%;padding:12px;border-radius:10px;border:1px solid var(--border);font-size:15px}
    textarea{min-height:110px}

    footer{padding:34px 0;color:var(--muted);font-size:14px}

    /* Small improvements for touch devices */
    .btn{min-height:44px;display:inline-flex;align-items:center;justify-content:center}
    input,textarea,button{touch-action:manipulation}

    /* responsive: stack columns on smaller screens */
    @media (max-width:960px){
      .visual-split{flex-direction:column}
      .visual-left{flex:0 0 auto}
      .visual-right{flex:0 0 auto}
      .cards-grid{grid-template-columns:1fr}
    }

    /* Mobile-specific rules */
    @media (max-width:720px){
      .header-inner{height:64px;padding:8px 0}
      .hero-grid{grid-template-columns:1fr}
      .hero-title{font-size:28px}
      body{font-size:17px}
      .logo-mark{width:44px;height:44px}
      .visual-left .big-image{border-radius:20px}
      .visual-left .big-image img{width:100%;object-position:center center} /* on mobile show center */

      /* Hide desktop nav, show toggle */
      .nav{display:none}
      .nav-toggle{display:inline-flex}

      /* Make right panel take full width and compress */
      .panel.card{padding:16px}
      .screenshot{height:160px}

      /* Form and CTAs: full width, larger hit area */
      .btn{width:100%}
      .small-cta{flex-direction:column}
      .hero-badges{flex-direction:column;align-items:flex-start}

      /* Contact layout: stack columns */
      #contact .container{display:block;padding:0}
      #contact > .container > div, #contact > .container > aside{width:100%;margin-bottom:18px}

      /* Nav drawer sheet action: make links touch-friendly */
      .nav-drawer .sheet .nav a{display:block;padding:12px;border-radius:8px}

      /* Slightly increase input size for mobile */
      input,textarea{font-size:16px;padding:14px}

      /* -----------------------------
         Mobile fixes added here:
         1) show full demo images (no bottom crop) by switching to contain and making containers auto-height
         2) nudge lists slightly left (less indentation)
         These rules affect only screens <=720px and won't change desktop/pc layout.
         ----------------------------- */

      /* Make big demo image fully visible (don't crop) */
      .visual-left .big-image{
        /* allow the image to determine height on small screens */
        min-height:0;
        height:auto;
        overflow:visible; /* allow image to be fully visible */
      }
      .visual-left .big-image img{
        width:100%;
        height:auto; /* natural height */
        object-fit:contain; /* show full image without cropping */
        object-position:center center;
        max-width:100%;
      }

      /* Also ensure the right-side small screenshot shows full image */
      .screenshot{
        height:auto;
        padding:12px; /* give some breathing room when image is taller */
        overflow:visible;
      }
      .screenshot img{
        width:100%;
        height:auto;
        object-fit:contain;
      }

      /* Nudge lists left across mobile views */
      .visual-right ul{margin-left:6px !important}
      /* make general lists less indented on mobile (program/ideas sections) */
      .info-card ul, #ideas ul{margin-left:10px !important; padding-left:16px !important}
      ul{padding-left:16px !important}

    }

    /* Very small screens / narrow devices */
    @media (max-width:420px){
      :root{--pad:16px}
      .hero-title{font-size:24px}
      .hero-lead{font-size:16px}
      .screenshot{height:140px}
      .header-inner{height:56px}
    }

    /* -------------------------
       Mobile fixes (only for <=720px)
       Narrow, targeted overrides — do not affect desktop
       ------------------------- */
    @media (max-width: 720px) {
      /* 1) Force vertical stacking for the contact section (overrides inline grid)
         and keep horizontal page padding so content isn't flush to the very edge */
      #contact .container {
        display: block !important;
        grid-template-columns: none !important;
        gap: 0 !important;
        padding: 0 var(--pad) !important; /* <-- preserved left/right padding on mobile */
      }
      /* Make the two columns full-width and add sensible spacing */
      #contact > .container > div,
      #contact > .container > aside {
        width: 100% !important;
        margin: 0 0 18px 0 !important;
      }

      /* Ensure the right-side panel looks good on mobile */
      #contact .panel.card {
        padding: 16px;
        box-sizing: border-box;
      }

      /* 2) Compact the top/header area on phones */
      /* hide the subtitle to save vertical space */
      .brand-sub {
        display: none;
      }
      /* shorten / truncate the brand title (keeps desktop intact) */
      .brand-title {
        font-size: 15px;
        max-width: 200px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
      /* slightly reduce header height on mobile for compactness */
      .header-inner {
        height: 56px;
      }

      /* Make hero lead shorter visually (limit to 2 lines) */
      .hero-lead {
        display: -webkit-box;
        -webkit-line-clamp: 2; /* show at most 2 lines */
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      /* Allow CTAs inside small panels to become full-width if needed */
      .panel.card .btn {
        width: 100%;
      }

      /* keep the existing mobile-specific rules consistent */
      .logo-mark { width:44px; height:44px; }
      .hero-title { font-size: 28px; }

      /* ============================
         Fixes requested:
         1) add left/right padding to header container so "PD" is not flush to the edge
         2) reduce vertical gaps above demo images on mobile
         3) same for second image (right panel)
         4) move lexer/parser/IR/codegen list slightly to the left
         ============================ */

      /* 1) Ensure header respects page padding on narrow devices */
      header.site-header .container {
        padding-left: var(--pad) !important;
        padding-right: var(--pad) !important;
      }
      /* also ensure header-inner keeps small vertical padding but not horizontal */
      .header-inner { padding-left: 0; padding-right: 0; }

      /* 2) Reduce the large top-margin for the demo card on mobile */
      /* (the card that contains the big demo image) */
      .demo-card {
        margin-top: 12px !important;
        padding-top: 16px; /* keep internal spacing comfortable */
      }
      /* reduce min-height of big-image on small phones to avoid large empty area */
      .visual-left .big-image { min-height: 180px; }

      /* 3) Reduce vertical spacing for the right-side screenshot (hero panel) */
      .hero { padding: 32px 0 12px; }
      .hero-grid { gap: 12px; }
      .panel.card { padding: 14px; }
      .screenshot { height: 140px; }

      /* 4) Nudge the list slightly left (less indentation) */
      .visual-right ul { margin-left: 8px !important; }

      /* Keep images centered and not oversized on tiny screens */
      .visual-left .big-image img { width:100%; object-position:center center; max-width: none; }

    }

  </style>
</head>
<body>

<header class="site-header">
  <div class="container header-inner">
    <div class="brand">
      <div class="logo-mark">PD</div>
      <div>
        <div class="brand-title">Проектная подготовка — языки и системы</div>
        <div class="brand-sub">Глубокие инженерные проекты для сильных школьников</div>
      </div>
    </div>

    <!-- Desktop nav (hidden on mobile) -->
    <nav class="nav" aria-label="Навигация">
      <a class="btn btn-ghost" href="#ideas">Идеи</a>
      <a class="btn btn-primary" href="#contact">Консультация</a>
    </nav>

    <!-- Mobile nav toggle -->
    <button class="nav-toggle" aria-label="Открыть меню" aria-expanded="false" id="navToggle">
      <span class="bar"></span>
      <span class="bar"></span>
      <span class="bar"></span>
    </button>
  </div>
</header>

<!-- Mobile nav drawer (hidden by default) -->
<div class="nav-drawer" id="navDrawer" aria-hidden="true">
  <div class="sheet" role="dialog" aria-modal="true" aria-label="Меню">
    <nav class="nav" aria-label="Меню">
      <a class="btn btn-ghost" href="#ideas" onclick="closeNav()">Идеи</a>
      <a class="btn btn-primary" href="#contact" onclick="closeNav()">Консультация</a>
      <a class="btn btn-ghost" href="#program" onclick="closeNav()">Программа</a>
    </nav>
  </div>
</div>

<main>
  <section class="hero">
    <div class="container hero-grid">
      <!-- LEFT: text -->
      <div>
        <h1 class="hero-title">Проекты уровня университета — для школьников</h1>
        <p class="hero-lead">
          Сопровождаем маленькие команды (1–2 человека) в создании настоящих инженерных проектов:
          собственные языки, компиляторы, JIT и низкоуровневые backend'ы.
        </p>

        <div class="admission-badge">
          Поступление без ЕГЭ (по результатам олимпиад) — реальная цель
        </div>

        <p class="hero-lead" style="margin-top:12px">
          Наша работа направлена на победы в профильных олимпиадах и конкурсах — это именно тот путь,
          который часто позволяет поступить в ведущие вузы по специальным условиям приёма.
        </p>

        <div class="hero-badges" aria-hidden="true" style="margin-top:14px">
          <div class="badge">Проекты, которые ценят жюри</div>
          <div class="badge">Подготовка и проект + алгоритмы</div>
        </div>
      </div>

      <!-- RIGHT: concise panel -->
      <aside class="panel card">
        <div style="display:flex;gap:12px;align-items:center">
          <div style="width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:grid;place-items:center;color:#fff;font-weight:700;font-family:Merriweather">6m</div>
          <div>
            <div style="font-weight:700">Треки: 6 / 12 месяцев</div>
            <div style="color:var(--muted);font-size:14px">Проектная работа + олимпиадная подготовка</div>
          </div>
        </div>

        <div style="margin-top:12px">
          <div style="font-weight:700;color:var(--accent);margin-bottom:8px">Демонстрация проекта</div>

          <div class="screenshot">
            <img id="heroImg" src="code_example_2.png" alt="Демонстрация проекта (code_example_2.png)" loading="lazy" onerror="this.style.display='none'">
            <div id="heroFallback" style="font-size:13px;color:var(--muted);padding:10px;text-align:center">
              Здесь будет пример демонстрации проекта
            </div>
          </div>
        </div>
      </aside>
    </div>
  </section>

  <!-- PROGRAM -->
  <section id="program" style="padding-bottom:10px">
    <div class="container">
      <div class="cards-grid">
        <div class="info-card">
          <h3>Коротко о подходе</h3>
          <p class="muted" style="margin-top:8px">
            Сначала — технологическая база: лексер, парсер, AST, IR, простая генерация кода. Затем —
            выбор проектной идеи и подготовка к демонстрации/защите и к олимпиадам.
          </p>
        </div>

        <div class="info-card">
          <h3>Как идёт сопровождение</h3>
          <p class="muted" style="margin-top:8px">
            Малые команды, регулярные встречи, code-review, контрольные точки и репетиции защит.
            Параллельно — тренировки по задачам алгоритмики.
          </p>
        </div>
      </div>

      <!-- demo card (added class demo-card for mobile-specific adjustments) -->
      <div style="margin-top:28px" class="info-card demo-card">
        <div class="visual-split">
          <div class="visual-left">
            <div class="big-image" aria-hidden="true">
              <img id="codeImg" src="code_example.png" alt="Пример фрагмента кода мини-языка" loading="lazy" onerror="this.style.display='none'">
            </div>
          </div>

          <div class="visual-right">
            <h4>Пример: мини-язык — как это выглядит</h4>
            <p class="muted">
              Фрагмент кода проходит путь от текста до исполнения.
            </p>

            <ul>
              <li><strong>Лексер → Парсер</strong> — строим AST и проверяем корректность.</li>
              <li><strong>IR и оптимизации</strong> — преобразовываем код и измеряем скорость исполнения.</li>
              <li><strong>Генерация кода / JIT</strong> — превращаем в исполняемый код и смотрим на результаты.</li>
            </ul>

            <p class="muted" style="margin-top:8px">
              Победы в профильных конкурсах (проектная и алгоритмическая части) дают реальную возможность
              поступать в лучшие вузы по особым правилам приёма — наш курс делает такую цель достижимой.
            </p>

            <div class="small-cta">
              <button class="btn btn-primary" type="button" onclick="scrollToContact()">Обсудить проект</button>
              <a class="btn btn-primary" href="#ideas" style="align-self:center">Идеи проектов</a>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top:22px" class="info-card">
        <h3>Путь к поступлению — кратко и честно</h3>
        <p class="muted" style="margin-top:8px">
          Сильный проект + высокие результаты в профильной олимпиаде часто открывают путь поступления
          в ведущие вузы без стандартной сдачи всех ЕГЭ (в рамках специальных условий приёма по результатам олимпиад).
          Это не автоматическая гарантия — но это реальная и проверяемая возможность, и мы помогаем пройти оба компонента:
          проектную и алгоритмическую части.
        </p>

        <div style="margin-top:12px;display:flex;gap:10px;flex-wrap:wrap">
          <div class="badge" style="font-weight:800;color:var(--accent)">Юниор / МИФИ</div>
          <div class="badge" style="font-weight:800;color:var(--accent)">Шаг в будущее / МГТУ</div>
          <div class="badge" style="font-weight:800;color:var(--accent)">Высший пилотаж / ВШЭ</div>
        </div>

        <p class="muted" style="margin-top:12px">
          Мы помогаем: подобрать идею, реализовать проект, подготовить ученика для алгоритмической части — всё, что важно для победы на конкурсах и олимпиадах.
        </p>
      </div>

    </div>
  </section>

  <!-- IDEAS -->
  <section id="ideas" style="padding-top:10px;padding-bottom:10px">
    <div class="container">
      <div class="info-card" style="padding:18px">
        <h3>Яркие идеи проектов</h3>
        <p class="muted" style="margin-top:8px">Идеи проектов, которые точно оценит жюри:</p>
        <ul style="margin-top:10px;color:var(--muted)">
          <li><strong>Модульный язык</strong> — каждый разработчик может добавить свою технологию в язык.</li>
          <li><strong>Интерпретатор байткода</strong> — маленький быстрый рантайм на ассемблере.</li>
          <li><strong>Оптимизатор семантики</strong> — ускоряет код через логические, а не шаблонные преобразования.</li>
          <li><strong>Компилируемый python</strong> — язык, который работает в сотни раз быстрее оригинальной версии.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" style="padding-top:10px;padding-bottom:40px">
    <div class="container" style="display:grid;grid-template-columns:1fr 420px;gap:24px;align-items:start">
      <div>
        <h2 style="font-family:Merriweather;margin:0 0 8px">Записаться на консультацию</h2>
        <p class="muted" style="margin:0 0 12px">Короткая встреча (20–30 минут): оценим уровень и обсудим дорожную карта к победам и поступлению.</p>

        <div class="contact-card" style="margin-top:12px">
          <form id="contactForm">
            <label for="name">Имя</label>
            <input id="name" name="name" placeholder="Как к вам обращаться" required>

            <label for="phone" style="margin-top:12px">Телефон</label>
            <input id="phone" name="phone" placeholder="+7 912 345-67-89" pattern="\+?\d[\d\s-]{6,}" required>

            <label for="info" style="margin-top:12px">Коротко: класс и цели</label>
            <textarea id="info" name="info" placeholder="Например: хочу поступать в МИФИ, знаю C++ и Python, увлекаюсь алгоритмами"></textarea>

            <div id="formNotice" style="margin-top:10px;color:var(--muted);font-size:13px;display:none"></div>

            <div style="margin-top:12px;display:flex;gap:12px;align-items:center;flex-wrap:wrap">
              <button class="btn btn-primary" type="submit">Отправить заявку</button>
              <div style="color:var(--muted);font-size:13px">Отвечу в течение пары часов</div>
            </div>
          </form>
        </div>
      </div>

      <aside>
        <div class="panel card" style="padding:18px">
          <!-- Заголовок: "Что подготовить" -->
          <h3 style="margin:0 0 8px">Что подготовить</h3>
          <p class="muted" style="margin:0 0 12px">Кратко опишите уровень ученика, примеры проектов (если есть) и цели по поступлению в университет.</p>
          <div style="margin-top:10px">
            <strong>Контакты</strong>
            <div style="margin-top:8px;color:var(--muted)">Email: <a href="mailto:misha13022008@gmail.com">misha13022008@gmail.com</a></div>
            <div style="margin-top:6px;color:var(--muted)">Telegram: <a href="https://t.me/Micodiy" target="_blank" rel="noopener noreferrer">@Micodiy</a></div>
          </div>
        </div>
      </aside>
    </div>
  </section>
</main>

<footer>
  <div class="container" style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:12px">
    <div style="min-width:220px">
      <strong>Проектная подготовка — языки и системы</strong>
      <div style="color:var(--muted);margin-top:6px">Проекты · JIT · Компиляторы · Подготовка к вузам</div>
    </div>
    <div style="color:var(--muted)">© <span id="year"></span></div>
  </div>
</footer>

<script>
  // Set year in footer
  document.getElementById('year').textContent = new Date().getFullYear();

  function scrollToContact(){
    document.getElementById('contact').scrollIntoView({behavior:'smooth'});
    // if mobile nav open, close it
    closeNav();
  }

  // Telegram username to open chat with (change if needed)
  const TELEGRAM_USERNAME = 'Micodiy';

  // Helper: build message from form fields
  function buildMessagePlain(name, phone, info){
    let parts = [];
    parts.push('Привет!');
    if(name) parts.push('Имя: ' + name);
    if(phone) parts.push('Телефон: ' + phone);
    if(info) parts.push('Коротко: ' + info);
    return parts.join('\n');
  }

  function isMobileUA(){
    return /Android|iPhone|iPad|iPod|Mobile|Windows Phone/i.test(navigator.userAgent);
  }

  function showNotice(text){
    const node = document.getElementById('formNotice');
    node.textContent = text;
    node.style.display = 'block';
    clearTimeout(node._hideTimeout);
    node._hideTimeout = setTimeout(()=>{ node.style.display = 'none'; }, 12000);
  }

  function openTelegramWithFallback(appUrl, webUrl){
    if(isMobileUA()){
      const iframe = document.createElement('iframe');
      iframe.style.display = 'none';
      iframe.src = appUrl;
      document.body.appendChild(iframe);

      const fallback = setTimeout(function(){
        const w = window.open(webUrl, '_blank');
        if(w) w.opener = null;
        try{ document.body.removeChild(iframe); }catch(e){}
      }, 900);

      setTimeout(function(){
        try{ document.body.removeChild(iframe); }catch(e){}
        clearTimeout(fallback);
      }, 2000);
    } else {
      const w = window.open(webUrl, '_blank');
      if(w) w.opener = null;
    }
  }

  document.getElementById('contactForm').addEventListener('submit', function(e){
    e.preventDefault();
    if(!this.checkValidity()){ this.reportValidity(); return; }

    const name = this.name.value.trim();
    const phone = this.phone.value.trim();
    const info = this.info.value.trim();

    if(!name){ showNotice('Пожалуйста, укажите имя.'); return; }
    if(!phone){ showNotice('Пожалуйста, укажите телефон.'); return; }

    const message = buildMessagePlain(name, phone, info);
    const encoded = encodeURIComponent(message);

    const appUrl = 'tg://resolve?domain=' + encodeURIComponent(TELEGRAM_USERNAME) + '&text=' + encoded;
    const webUrl = 'https://t.me/' + encodeURIComponent(TELEGRAM_USERNAME) + '?text=' + encoded;

    openTelegramWithFallback(appUrl, webUrl);

    showNotice('Открываем Telegram... Если ничего не произошло — откроется веб-версия.');
    this.reset();
  });

  // Hide fallback text if images load
  (function(){
    const heroImg = document.getElementById('heroImg');
    const heroFallback = document.getElementById('heroFallback');
    if(heroImg){
      heroImg.addEventListener('load', ()=>{ if(heroFallback) heroFallback.style.display='none'; });
      heroImg.addEventListener('error', ()=>{ if(heroFallback) heroFallback.style.display='block'; });
      if(heroImg.complete && heroImg.naturalWidth){ if(heroFallback) heroFallback.style.display='none'; }
    }
    const codeImg = document.getElementById('codeImg');
    if(codeImg){ codeImg.addEventListener('error', ()=>{ /* nothing to show */ }); }
  })();

  // Mobile nav toggle logic
  const navToggle = document.getElementById('navToggle');
  const navDrawer = document.getElementById('navDrawer');
  function openNav(){
    navDrawer.style.display = 'flex';
    navDrawer.setAttribute('aria-hidden','false');
    navToggle.setAttribute('aria-expanded','true');
    // trap focus: focus the first focusable in drawer
    const first = navDrawer.querySelector('a, button');
    if(first) first.focus();
    document.body.style.overflow = 'hidden';
  }
  function closeNav(){
    navDrawer.style.display = 'none';
    navDrawer.setAttribute('aria-hidden','true');
    navToggle.setAttribute('aria-expanded','false');
    document.body.style.overflow = '';
  }
  if(navToggle){
    navToggle.addEventListener('click', function(){
      const open = navDrawer.style.display === 'flex';
      if(open) closeNav(); else openNav();
    });
  }
  // close drawer when clicking overlay outside sheet
  if(navDrawer){
    navDrawer.addEventListener('click', function(e){
      if(e.target === navDrawer) closeNav();
    });
    // close on Escape
    document.addEventListener('keydown', function(e){ if(e.key === 'Escape') closeNav(); });
  }

</script>
</body>
</html>
